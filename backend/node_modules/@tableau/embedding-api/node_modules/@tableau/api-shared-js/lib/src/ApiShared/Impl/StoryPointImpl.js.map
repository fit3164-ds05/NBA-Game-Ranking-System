{"version":3,"file":"StoryPointImpl.js","sourceRoot":"","sources":["../../../../src/ApiShared/Impl/StoryPointImpl.ts"],"names":[],"mappings":"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","sourcesContent":["import * as Contract from '@tableau/api-external-contract-js';\nimport { ContainedSheetInfoModel, SheetInfo, SheetPath, VisualId } from '@tableau/api-internal-contract-js';\nimport { TableauError } from '../TableauError';\nimport { SheetUtils } from '../Utils/SheetUtils';\nimport { DashboardImpl } from './DashboardImpl';\nimport { SheetImpl } from './SheetImpl';\nimport { SheetInfoImpl } from './SheetInfoImpl';\nimport { StoryImpl } from './StoryImpl';\nimport { StoryPointInfoImpl } from './StoryPointInfoImpl';\nimport { WorksheetImpl } from './WorksheetImpl';\n\nexport class StoryPointImpl {\n  private _containedSheetImpl: SheetImpl;\n  constructor(\n    private _storyPointInfoImpl: StoryPointInfoImpl,\n    sheetInfos: Array<SheetInfo>,\n    registryId: number,\n    containedSheetInfo?: ContainedSheetInfoModel,\n  ) {\n    if (containedSheetInfo) {\n      this._containedSheetImpl = this.createContainedSheet(containedSheetInfo, sheetInfos, registryId);\n    }\n  }\n\n  public get index(): number {\n    return this._storyPointInfoImpl.index;\n  }\n\n  public get caption(): string {\n    return this._storyPointInfoImpl.caption;\n  }\n\n  public get active(): boolean {\n    return this._storyPointInfoImpl.active;\n  }\n\n  public get updated(): boolean {\n    return this._storyPointInfoImpl.updated;\n  }\n\n  public set updated(updated: boolean) {\n    this._storyPointInfoImpl.updated = updated;\n  }\n\n  public get parentStory(): StoryImpl {\n    return this._storyPointInfoImpl.parentStory;\n  }\n\n  public get containedSheet(): SheetImpl | undefined {\n    return this._containedSheetImpl;\n  }\n\n  public get storyPointId(): number {\n    return this._storyPointInfoImpl.storyPointId;\n  }\n\n  private createContainedSheet(containedSheetInfo: ContainedSheetInfoModel, sheetInfos: Array<SheetInfo>, registryId: number): SheetImpl {\n    const containedSheetIdx = -1;\n\n    const publishedSheetInfo = SheetUtils.getPublishedSheetInfoByName(containedSheetInfo.name, sheetInfos);\n    const containedSheetSize = SheetUtils.createAutomaticSize();\n    const isContainedSheetHidden = publishedSheetInfo === undefined;\n    const containedSheetUrl = publishedSheetInfo ? publishedSheetInfo.url : '';\n    // Contained sheets aren't active - the containing sheet is active.\n    const containedSheetActive = false;\n\n    const containedSheetInfoImpl = new SheetInfoImpl(\n      containedSheetInfo.name,\n      SheetUtils.getSheetTypeEnum(containedSheetInfo.sheetType),\n      containedSheetSize,\n      containedSheetIdx,\n      containedSheetActive,\n      isContainedSheetHidden,\n      containedSheetUrl,\n    );\n\n    let sheetImpl: SheetImpl;\n    switch (containedSheetInfoImpl.sheetType) {\n      case Contract.SheetType.Worksheet: {\n        const vizId: VisualId = {\n          worksheet: containedSheetInfoImpl.name,\n        };\n\n        sheetImpl = new WorksheetImpl(containedSheetInfoImpl, registryId, vizId, null, this);\n        break;\n      }\n      case Contract.SheetType.Dashboard: {\n        const sheetPath: SheetPath = {\n          sheetName: containedSheetInfoImpl.name,\n          isDashboard: true,\n        };\n\n        sheetImpl = new DashboardImpl(containedSheetInfoImpl, containedSheetInfo.dashboardZones, sheetPath, registryId, this);\n        break;\n      }\n      default: {\n        throw new TableauError(Contract.SharedErrorCodes.ServerError, 'Invalid SheetType');\n      }\n    }\n\n    return sheetImpl;\n  }\n}\n"]}